<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimation of the confidence envelope of the Kd function under its null hypothesis — KdEnvelope • dbmss</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Estimation of the confidence envelope of the Kd function under its null hypothesis — KdEnvelope" />
<meta property="og:description" content="Simulates point patterns according to the null hypothesis and returns the envelope of Kd according to the confidence level." />
<meta property="og:image" content="https://ericmarcon.github.io/dbmss/logo.png" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dbmss</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">2.7-4.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dbmss.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/bandwidth.html">Bandwidth choice</a>
    </li>
    <li>
      <a href="../articles/articles/reference.html">dbmss Package Reference</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EricMarcon/dbmss/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimation of the confidence envelope of the Kd function under its null hypothesis</h1>
    
    <div class="hidden name"><code>KdEnvelope.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulates point patterns according to the null hypothesis and returns the envelope of <em>Kd</em> according to the confidence level.</p>
    </div>

    <pre class="usage"><span class='fu'>KdEnvelope</span><span class='op'>(</span><span class='va'>X</span>, r <span class='op'>=</span> <span class='cn'>NULL</span>, NumberOfSimulations <span class='op'>=</span> <span class='fl'>100</span>, Alpha <span class='op'>=</span> <span class='fl'>0.05</span>, <span class='va'>ReferenceType</span>, 
           NeighborType <span class='op'>=</span> <span class='va'>ReferenceType</span>, Weighted <span class='op'>=</span> <span class='cn'>FALSE</span>, Original <span class='op'>=</span> <span class='cn'>TRUE</span>, 
           Approximate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>$</span><span class='va'>n</span> <span class='op'>&lt;</span> <span class='fl'>10000</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, Adjust <span class='op'>=</span> <span class='fl'>1</span>, MaxRange <span class='op'>=</span> <span class='st'>"ThirdW"</span>, 
           StartFromMinR <span class='op'>=</span> <span class='cn'>FALSE</span>,
           SimulationType <span class='op'>=</span> <span class='st'>"RandomLocation"</span>, Global <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>A point pattern (<code><a href='wmppp.object.html'>wmppp.object</a></code>) or a <code><a href='Dtable.html'>Dtable</a></code> object.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>A vector of distances. If <code>NULL</code>, a default value is set: 512 equally spaced values are used, and the first 256 are returned, corresponding to half the maximum distance between points (following Duranton and Overman, 2005).</p></td>
    </tr>
    <tr>
      <th>NumberOfSimulations</th>
      <td><p>The number of simulations to run, 100 by default.</p></td>
    </tr>
    <tr>
      <th>Alpha</th>
      <td><p>The risk level, 5% by default.</p></td>
    </tr>
    <tr>
      <th>ReferenceType</th>
      <td><p>One of the point types.</p></td>
    </tr>
    <tr>
      <th>NeighborType</th>
      <td><p>One of the point types. By default, the same as reference type.</p></td>
    </tr>
    <tr>
      <th>Weighted</th>
      <td><p>Logical; if <code>TRUE</code>, estimates the <em>Kemp</em> function.</p></td>
    </tr>
    <tr>
      <th>Original</th>
      <td><p>Logical; if <code>TRUE</code> (by default), the original bandwidth selection by Duranton and Overman (2005) following Silverman (2006: eq 3.31) is used. If <code>FALSE</code>, it is calculated following Sheather and Jones (1991), <em>i.e.</em> the state of the art. See <code><a href='https://rdrr.io/r/stats/bandwidth.html'>bw.SJ</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>Approximate</th>
      <td><p>if not 0 (1 is a good choice), exact distances between pairs of points are rounded to 1024 times <code>Approximate</code> single values equally spaced between 0 and the largest distance. This technique (Scholl and Brenner, 2015) allows saving a lot of memory when addressing large point sets (the default value is 1 over 10000 points). Increasing <code>Approximate</code> allows better precision at the cost of proportional memory use. Ignored if <code>X</code> is a <code><a href='Dtable.html'>Dtable</a></code> object.</p></td>
    </tr>
    <tr>
      <th>Adjust</th>
      <td><p>Force the automatically selected bandwidth (following Silverman, 1986) to be multiplied by <code>Adjust</code>. Setting it to values lower than one (1/2 for example) will sharpen the estimation. If not 1, <code>Original</code> is ignored.</p></td>
    </tr>
    <tr>
      <th>MaxRange</th>
      <td><p>The maximum value of <code>r</code> to consider, ignored if <code>r</code> is not <code>NULL</code>. Default is "ThirdW", one third of the diameter of the window. Other choices are "HalfW", and "QuarterW" and "D02005".
  "HalfW", and "QuarterW" are for half or the quarter of the diameter of the window.
  "D02005" is for the median distance observed between points, following Duranton and Overman (2005). "ThirdW" should be close to "DO2005" but has the advantage to be independent of the point types chosen as <code>ReferenceType</code> and <code>NeighborType</code>, to simplify comparisons between different types. "D02005" is approximated by "ThirdW" if <code>Approximate</code> is not 0.
  if <code>X</code> is a <code><a href='Dtable.html'>Dtable</a></code> object, the diameter of the window is taken as the max distance between points.</p></td>
    </tr>
    <tr>
      <th>StartFromMinR</th>
      <td><p>Logical; if <code>TRUE</code>, points are assumed to be further from each other than the minimum observed distance, So <em>Kd</em> will not be estimated below it: it is assumed to be 0. If <code>FALSE</code>, by default, distances are smoothed down to $r=0$.
  Ignored if <code>Approximate</code> is not 0: then, estimation always starts from $r=0$.</p></td>
    </tr>
    <tr>
      <th>SimulationType</th>
      <td><p>A string describing the null hypothesis to simulate. The null hypothesis may be
  "<em>RandomLocation</em>": points are redistributed on the actual locations (default);
  "<em>RandomLabeling</em>": randomizes point types, keeping locations and weights unchanged;
  "<em>PopulationIndependence</em>": keeps reference points unchanged, randomizes other point locations.</p></td>
    </tr>
    <tr>
      <th>Global</th>
      <td><p>Logical; if <code>TRUE</code>, a global envelope sensu Duranton and Overman (2005) is calculated.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This envelope is local by default, that is to say it is computed separately at each distance. See Loosmore and Ford (2006) for a discussion.</p>  
<p>The global envelope is calculated by iteration: the simulations reaching one of the upper or lower values at any distance are eliminated at each step. The process is repeated until <em>Alpha / Number of simulations</em> simulations are dropped. The remaining upper and lower bounds at all distances constitute the global envelope. Interpolation is used if the exact ratio cannot be reached.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An envelope object (<code>envelope</code>). There are methods for print and plot for this class.</p>  
<p>The <code>fv</code> contains the observed value of the function, its average simulated value and the confidence envelope.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Duranton, G. and Overman, H. G. (2005). Testing for Localisation Using Micro-Geographic Data. <em>Review of Economic Studies</em> 72(4): 1077-1106.</p>  
<p>Kenkel, N. C. (1988). Pattern of Self-Thinning in Jack Pine: Testing the Random Mortality Hypothesis. <em>Ecology</em> 69(4): 1017-1024.</p>  
<p>Loosmore, N. B. and Ford, E. D. (2006). Statistical inference using the G or K point pattern spatial statistics. <em>Ecology</em> 87(8): 1925-1931.</p>  
<p>Marcon, E. and F. Puech (2017). A typology of distance-based measures of spatial concentration. <em>Regional Science and Urban Economics</em>. 62:56-67.</p>
<p>Scholl, T. and Brenner, T. (2015) Optimizing distance-based methods for large data sets, <em>Journal of Geographical Systems</em> 17(4): 333-351.</p>
<p>Silverman, B. W. (1986). <em>Density estimation for statistics and data analysis</em>. Chapman and Hall, London.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Eric Marcon &lt;Eric.Marcon@ecofog.gf&gt;</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='Kdhat.html'>Kdhat</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>paracou16</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>paracou16</span><span class='op'>[</span><span class='va'>paracou16</span><span class='op'>$</span><span class='va'>marks</span><span class='op'>$</span><span class='va'>PointType</span><span class='op'>==</span><span class='st'>"Q. Rosea"</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='img'><img src='KdEnvelope-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Calculate confidence envelope</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>KdEnvelope</span><span class='op'>(</span><span class='va'>paracou16</span>, , ReferenceType<span class='op'>=</span><span class='st'>"Q. Rosea"</span>, Global<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Generating 100 simulations by evaluating expression  ...
#&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
#&gt; 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
#&gt; 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99,  100.
#&gt; 
#&gt; Done.</div><div class='input'>
<span class='co'># Center of the confidence interval</span>
<span class='fu'><a href='Kdhat.html'>Kdhat</a></span><span class='op'>(</span><span class='va'>paracou16</span>, ReferenceType<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>kd</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>kd</span><span class='op'>$</span><span class='va'>Kd</span> <span class='op'>~</span> <span class='va'>kd</span><span class='op'>$</span><span class='va'>r</span>, lty<span class='op'>=</span><span class='fl'>3</span>, col<span class='op'>=</span><span class='st'>"green"</span><span class='op'>)</span>
</div><div class='img'><img src='KdEnvelope-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Eric Marcon, Gabriel Lang, Stephane Traissac, Florence Puech.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '34d07893d7877757953d7bd46f236a5e',
    indexName: 'dbmss',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


