<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Estimates the Kd function"><title>Estimation of the Kd function — Kdhat • dbmss</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimation of the Kd function — Kdhat"><meta property="og:description" content="Estimates the Kd function"><meta property="og:image" content="https://ericmarcon.github.io/dbmss/logo.png"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dbmss</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.7-10.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/dbmss.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/bandwidth.html">Bandwidth choice</a>
    <a class="dropdown-item" href="../articles/reference.html">dbmss Package Reference</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/EricMarcon/dbmss/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimation of the Kd function</h1>
      
      <div class="d-none name"><code>Kdhat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates the <em>Kd</em> function</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Kdhat</span><span class="op">(</span><span class="va">X</span>, r <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">ReferenceType</span>, NeighborType <span class="op">=</span> <span class="va">ReferenceType</span>, Weighted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>       Original <span class="op">=</span> <span class="cn">TRUE</span>, Approximate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">X</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">10000</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, Adjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       MaxRange <span class="op">=</span> <span class="st">"ThirdW"</span>, StartFromMinR <span class="op">=</span> <span class="cn">FALSE</span>, CheckArguments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>X</dt>
<dd><p>A weighted, marked planar point pattern (<code><a href="wmppp.object.html">wmppp.object</a></code>) or a <code><a href="Dtable.html">Dtable</a></code> object.</p></dd>

  <dt>r</dt>
<dd><p>A vector of distances. If <code>NULL</code>, a default value is set: 512 equally spaced values are used, from the smallest distance between points to half the diameter of the window.</p></dd>

  <dt>ReferenceType</dt>
<dd><p>One of the point types. If "", all points are considered (this is not the default value; <code>NeighborType</code> is ignored then) to estimate the average value of simulated <em>Kd</em> values under the null hypothesis of <em>RandomLocation</em> (Marcon and Puech, 2012).</p></dd>

  <dt>NeighborType</dt>
<dd><p>One of the point types. By default, the same as reference type.</p></dd>

  <dt>Weighted</dt>
<dd><p>Logical; if <code>TRUE</code>, estimates the <em>Kemp</em> function.</p></dd>

  <dt>Original</dt>
<dd><p>Logical; if <code>TRUE</code> (by default), the original bandwidth selection by Duranton and Overman (2005) following Silverman (1986: eq 3.31) is used. If <code>FALSE</code>, it is calculated following Sheather and Jones (1991), <em>i.e.</em> the state of the art. See <code><a href="https://rdrr.io/r/stats/bandwidth.html" class="external-link">bw.SJ</a></code> for more details.</p></dd>

  <dt>Approximate</dt>
<dd><p>if not 0 (1 is a good choice), exact distances between pairs of points are rounded to 1024 times <code>Approximate</code> single values equally spaced between 0 and the largest distance. This technique (Scholl and Brenner, 2015) allows saving a lot of memory when addressing large point sets (the default value is 1 over 10000 points). Increasing <code>Approximate</code> allows better precision at the cost of proportional memory use. Ignored if <code>X</code> is a <code><a href="Dtable.html">Dtable</a></code> object.</p></dd>

  <dt>Adjust</dt>
<dd><p>Force the automatically selected bandwidth (following <code>Original</code>) to be multiplied by <code>Adjust</code>. Setting it to values lower than one (1/2 for example) will sharpen the estimation.</p></dd>

  <dt>MaxRange</dt>
<dd><p>The maximum value of <code>r</code> to consider, ignored if <code>r</code> is not <code>NULL</code>. Default is "ThirdW", one third of the diameter of the window. Other choices are "HalfW", and "QuarterW" and "D02005".
  "HalfW", and "QuarterW" are for half or the quarter of the diameter of the window.
  "D02005" is for the median distance observed between points, following Duranton and Overman (2005). "ThirdW" should be close to "DO2005" but has the advantage to be independent of the point types chosen as <code>ReferenceType</code> and <code>NeighborType</code>, to simplify comparisons between different types. "D02005" is approximated by "ThirdW" if <code>Approximate</code> is not 0.
  if <code>X</code> is a <code><a href="Dtable.html">Dtable</a></code> object, the diameter of the window is taken as the max distance between points.</p></dd>

  <dt>StartFromMinR</dt>
<dd><p>Logical; if <code>TRUE</code>, points are assumed to be further from each other than the minimum observed distance, So <em>Kd</em> will not be estimated below it: it is assumed to be 0. If <code>FALSE</code>, distances are smoothed down to \(r=0\).
  Ignored if <code>Approximate</code> is not 0: then, estimation always starts from \(r=0\).</p></dd>

  <dt>CheckArguments</dt>
<dd><p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time in simulations for example, when the arguments have been checked elsewhere.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><em>Kd</em> is a density, absolute measure of a point pattern structure. <em>Kd</em> is computed efficiently by building a matrix of distances between point pairs and calculating the density of their distribution (the default values of <code>r</code> are those of the <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></code> function). The kernel estimator is Gaussian.</p>  
<p>The weighted <em>Kd</em> function has been named <em>Kemp</em> (<em>emp</em> is for employees) by Duranton and Overman (2005).</p>  
<p>If <code>X</code> is not a <code><a href="Dtable.html">Dtable</a></code> object, the maximum value of <code>r</code> is obtained from the geometry of the window rather than caculating the median distance between points as suggested by Duranton and Overman (2005) to save (a lot of) calculation time.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>fv</code>, see <code>fv.object</code>, which can be plotted directly using <code>plot.fv</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Estimating <em>Kd</em> relies on calculating distances, exactly or approximately (if <code>Approximate</code> is not 0).
  Then distances are smoothed by estimating their probability density.
  Reflection is used to estimate density close to the lowest distance, that is the minimum observed distance (if <code>StartFromMinR</code> is <code>TRUE</code>) or 0: all distances below 4 times the estimation kernel bandwith apart from the lowest distance are duplicated (symmetrically with respect to the lowest distance) to avoid edge effects (underestimation of the density close to the lowest distance).</p>  
<p>Density estimation heavily relies on the bandwith.
  Starting from version 2.7, the optimal bandwith is computed from the distribution of distances between pairs of points up to twice the maximum distance considered.
  The consequence is that choosing a smaller range of distances in argument <code>r</code> results in less smoothed \(Kd\) values.
  The default values (<code>r = NULL</code>, <code>MaxRange = "ThirdW"</code>) are such that almost all the pairs of points (except those more than 2/3 of the window diameter apart) are taken into account to determine the bandwith.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Duranton, G. and Overman, H. G. (2005). Testing for Localisation Using Micro-Geographic Data. <em>Review of Economic Studies</em> 72(4): 1077-1106.</p>  
<p>Marcon, E. and F. Puech (2017). A typology of distance-based measures of spatial concentration. <em>Regional Science and Urban Economics</em>. 62:56-67.</p>  
<p>Scholl, T. and Brenner, T. (2015) Optimizing distance-based methods for large data sets, <em>Journal of Geographical Systems</em> 17(4): 333-351.</p>
<p>Sheather, S. J. and Jones, M. C. (1991) A reliable data-based bandwidth selection method for kernel density estimation. <em>Journal of the Royal Statistical Society series B</em>, 53, 683-690.</p>  
<p>Silverman, B. W. (1986). <em>Density estimation for statistics and data analysis</em>. Chapman and Hall, London.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="KdEnvelope.html">KdEnvelope</a></code>, <code><a href="Mhat.html">Mhat</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">paracou16</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">paracou16</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Kdhat-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate Kd</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">Paracou</span> <span class="op">&lt;-</span> <span class="fu">Kdhat</span><span class="op">(</span><span class="va">paracou16</span>, , <span class="st">"Q. Rosea"</span>, <span class="st">"V. Americana"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Function value object (class ‘fv’)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for the function r -&gt; Kd(r)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .................................</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Math.label Description        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r  r          distance argument r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kd hat(Kd)(r) Estimated Kd(r)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .................................</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Default plot formula:  .~r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> where “.” stands for ‘Kd’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Recommended range of argument r: [0, 102.11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Available range of argument r: [0, 102.11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unit of length: 1 meter</span>
<span class="r-in"><span><span class="co"># Plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">Paracou</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Kdhat-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Eric Marcon, Gabriel Lang, Stephane Traissac, Florence Puech.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

