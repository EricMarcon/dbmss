<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimation of the confidence envelope of the m function under its null hypothesis — mEnvelope • dbmss</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimation of the confidence envelope of the m function under its null hypothesis — mEnvelope"><meta name="description" content="Simulates point patterns according to the null hypothesis and returns the envelope of m according to the confidence level."><meta property="og:description" content="Simulates point patterns according to the null hypothesis and returns the envelope of m according to the confidence level."><meta property="og:image" content="https://ericmarcon.github.io/dbmss/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dbmss</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.9-2.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dbmss.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bandwidth.html">Bandwidth choice</a></li>
    <li><a class="dropdown-item" href="../articles/maps.html">Mapping local values of measures</a></li>
    <li><a class="dropdown-item" href="../articles/reference.html">dbmss Package Reference</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EricMarcon/dbmss/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimation of the confidence envelope of the m function under its null hypothesis</h1>

      <div class="d-none name"><code>m_Envelope.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulates point patterns according to the null hypothesis and returns the envelope of <em>m</em> according to the confidence level.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mEnvelope</span><span class="op">(</span><span class="va">X</span>, r <span class="op">=</span> <span class="cn">NULL</span>, NumberOfSimulations <span class="op">=</span> <span class="fl">100</span>, Alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>          <span class="va">ReferenceType</span>, NeighborType <span class="op">=</span> <span class="va">ReferenceType</span>, CaseControl <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          Original <span class="op">=</span> <span class="cn">TRUE</span>, Approximate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">X</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">10000</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, Adjust <span class="op">=</span> <span class="fl">1</span>, </span>
<span>          MaxRange <span class="op">=</span> <span class="st">"ThirdW"</span>, SimulationType <span class="op">=</span> <span class="st">"RandomLocation"</span>, Global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A point pattern (<code><a href="wmppp.object.html">wmppp.object</a></code>).</p></dd>

  <dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>A vector of distances. If <code>NULL</code>, a default value is set: 512 equally spaced values are used up to the median distance between points (following Duranton and Overman, 2005).</p></dd>

  <dt id="arg-numberofsimulations">NumberOfSimulations<a class="anchor" aria-label="anchor" href="#arg-numberofsimulations"></a></dt>
<dd><p>The number of simulations to run, 100 by default.</p></dd>

  <dt id="arg-alpha">Alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The risk level, 5% by default.</p></dd>

  <dt id="arg-referencetype">ReferenceType<a class="anchor" aria-label="anchor" href="#arg-referencetype"></a></dt>
<dd><p>One of the point types.</p></dd>

  <dt id="arg-neighbortype">NeighborType<a class="anchor" aria-label="anchor" href="#arg-neighbortype"></a></dt>
<dd><p>One of the point types, equal to the reference type by default to caculate univariate M.</p></dd>

  <dt id="arg-casecontrol">CaseControl<a class="anchor" aria-label="anchor" href="#arg-casecontrol"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, the case-control version of <em>M</em> is computed. <em>ReferenceType</em> points are cases, <em>NeighborType</em> points are controls.</p></dd>

  <dt id="arg-original">Original<a class="anchor" aria-label="anchor" href="#arg-original"></a></dt>
<dd><p>Logical; if <code>TRUE</code> (by default), the original bandwidth selection by Duranton and Overman (2005) following Silverman (1986: eq 3.31) is used. If <code>FALSE</code>, it is calculated following Sheather and Jones (1991), <em>i.e.</em> the state of the art. See <code><a href="https://rdrr.io/r/stats/bandwidth.html" class="external-link">bw.SJ</a></code> for more details.</p></dd>

  <dt id="arg-approximate">Approximate<a class="anchor" aria-label="anchor" href="#arg-approximate"></a></dt>
<dd><p>if not 0 (1 is a good choice), exact distances between pairs of points are rounded to 1024 times <code>Approximate</code> single values equally spaced between 0 and the largest distance. This technique (Scholl and Brenner, 2015) allows saving a lot of memory when addressing large point sets (the default value is 1 over 10000 points). Increasing <code>Approximate</code> allows better precision at the cost of proportional memory use.</p></dd>

  <dt id="arg-adjust">Adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>Force the automatically selected bandwidth (following <code>Original</code>) to be multiplied by <code>Adjust</code>. Setting it to values lower than one (1/2 for example) will sharpen the estimation.</p></dd>

  <dt id="arg-maxrange">MaxRange<a class="anchor" aria-label="anchor" href="#arg-maxrange"></a></dt>
<dd><p>The maximum value of <code>r</code> to consider, ignored if <code>r</code> is not <code>NULL</code>. Default is "ThirdW", one third of the diameter of the window. Other choices are "HalfW", and "QuarterW" and "D02005".
  "HalfW", and "QuarterW" are for half or the quarter of the diameter of the window.
  "D02005" is for the median distance observed between points, following Duranton and Overman (2005). "ThirdW" should be close to "DO2005" but has the advantage to be independent of the point types chosen as <code>ReferenceType</code> and <code>NeighborType</code>, to simplify comparisons between different types. "D02005" is approximated by "ThirdW" if <code>Approximate</code> is not 0.</p></dd>

  <dt id="arg-simulationtype">SimulationType<a class="anchor" aria-label="anchor" href="#arg-simulationtype"></a></dt>
<dd><p>A string describing the null hypothesis to simulate. The null hypothesis may be
  "<em>RandomLocation</em>": points are redistributed on the actual locations (default);
  "<em>RandomLabeling</em>": randomizes point types, keeping locations and weights unchanged;
  "<em>PopulationIndependence</em>": keeps reference points unchanged, randomizes other point locations.</p></dd>

  <dt id="arg-global">Global<a class="anchor" aria-label="anchor" href="#arg-global"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, a global envelope sensu Duranton and Overman (2005) is calculated.</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, print progress reports during the simulations.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This envelope is local by default, that is to say it is computed separately at each distance. See Loosmore and Ford (2006) for a discussion.</p>
<p>The global envelope is calculated by iteration: the simulations reaching one of the upper or lower values at any distance are eliminated at each step. The process is repeated until <em>Alpha / Number of simulations</em> simulations are dropped. The remaining upper and lower bounds at all distances constitute the global envelope. Interpolation is used if the exact ratio cannot be reached.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An envelope object (<code><a href="https://rdrr.io/pkg/spatstat.explore/man/envelope.html" class="external-link">envelope</a></code>). There are methods for print and plot for this class.</p>
<p>The <code>fv</code> contains the observed value of the function, its average simulated value and the confidence envelope.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Duranton, G. and Overman, H. G. (2005). Testing for Localisation Using Micro-Geographic Data. <em>Review of Economic Studies</em> 72(4): 1077-1106.</p>
<p>Kenkel, N. C. (1988). Pattern of Self-Thinning in Jack Pine: Testing the Random Mortality Hypothesis. <em>Ecology</em> 69(4): 1017-1024.</p>
<p>Lang G., Marcon E. and Puech F. (2014) Distance-Based Measures of Spatial Concentration: Introducing a Relative Density Function. <em>HAL</em> 01082178, 1-18.</p>
<p>Loosmore, N. B. and Ford, E. D. (2006). Statistical inference using the G or K point pattern spatial statistics. <em>Ecology</em> 87(8): 1925-1931.</p>
<p>Marcon, E. and F. Puech (2017). A typology of distance-based measures of spatial concentration. <em>Regional Science and Urban Economics</em>. 62:56-67.</p>
<p>Scholl, T. and Brenner, T. (2015) Optimizing distance-based methods for large data sets, <em>Journal of Geographical Systems</em> 17(4): 333-351.</p>
<p>Silverman, B. W. (1986). <em>Density estimation for statistics and data analysis</em>. Chapman and Hall, London.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="m_hat.html">mhat</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">paracou16</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Keep only 50% of points to run this example</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="as.wmppp.html">as.wmppp</a></span><span class="op">(</span><span class="fu">rthin</span><span class="op">(</span><span class="va">paracou16</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">X</span>, </span></span>
<span class="r-in"><span>  labelSize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Basal area ("</span> <span class="op">~</span><span class="va">cm</span><span class="op">^</span><span class="fl">2</span><span class="op">~</span> <span class="st">")"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  labelColor <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="m_Envelope-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate confidence envelope (should be 1000 simulations, reduced to 4 to save time)</span></span></span>
<span class="r-in"><span><span class="va">NumberOfSimulations</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">Alpha</span> <span class="op">&lt;-</span> <span class="fl">.10</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="fu">mEnvelope</span><span class="op">(</span><span class="va">X</span>, , <span class="va">NumberOfSimulations</span>, <span class="va">Alpha</span>, </span></span>
<span class="r-in"><span>    <span class="st">"V. Americana"</span>, <span class="st">"Q. Rosea"</span>, Original <span class="op">=</span> <span class="cn">FALSE</span>, SimulationType <span class="op">=</span> <span class="st">"RandomLabeling"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="m_Envelope-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Marcon, Gabriel Lang, Stephane Traissac, Florence Puech.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

