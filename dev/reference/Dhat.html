<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimation of the D function — Dhat • dbmss</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimation of the D function — Dhat"><meta name="description" content="Estimates the D function"><meta property="og:description" content="Estimates the D function"><meta property="og:image" content="https://ericmarcon.github.io/dbmss/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dbmss</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.9-2.9106</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dbmss.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bandwidth.html">Bandwidth choice</a></li>
    <li><a class="dropdown-item" href="../articles/maps.html">Mapping local values of measures</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel simulations</a></li>
    <li><a class="dropdown-item" href="../articles/reference.html">dbmss Package Reference</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EricMarcon/dbmss/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimation of the D function</h1>

      <div class="d-none name"><code>Dhat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates the <em>D</em> function</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Dhat</span><span class="op">(</span><span class="va">X</span>, r <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">Cases</span>, Controls <span class="op">=</span> <span class="cn">NULL</span>, Intertype <span class="op">=</span> <span class="cn">FALSE</span>, CheckArguments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A weighted, marked, planar point pattern (<code><a href="wmppp.object.html">wmppp.object</a></code>).</p></dd>

  <dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>A vector of distances. If <code>NULL</code>, a sensible default value is chosen (512 intervals, from 0 to half the diameter of the window) following <strong>spatstat</strong>.</p></dd>

  <dt id="arg-cases">Cases<a class="anchor" aria-label="anchor" href="#arg-cases"></a></dt>
<dd><p>One of the point types.</p></dd>

  <dt id="arg-controls">Controls<a class="anchor" aria-label="anchor" href="#arg-controls"></a></dt>
<dd><p>One of the point types. If <code>NULL</code>, controls are all types except for cases.</p></dd>

  <dt id="arg-intertype">Intertype<a class="anchor" aria-label="anchor" href="#arg-intertype"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, <em>D</em> is computed as <em>Di</em> in Marcon and Puech (2012).</p></dd>

  <dt id="arg-checkarguments">CheckArguments<a class="anchor" aria-label="anchor" href="#arg-checkarguments"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time in simulations for example, when the arguments have been checked elsewhere.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <em>Di</em> function allows comparing the structure of the cases to that of the controls around cases, that is to say the comparison is made around the same points. This has been advocated by Arbia et al. (2008) and formalized by Marcon and Puech (2012).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>fv</code>, see <code><a href="https://rdrr.io/pkg/spatstat.explore/man/fv.object.html" class="external-link">fv.object</a></code>, which can be plotted directly using <code><a href="https://rdrr.io/pkg/spatstat.explore/man/plot.fv.html" class="external-link">plot.fv</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Arbia, G., Espa, G. and Quah, D. (2008). A class of spatial econometric methods in the empirical analysis of clusters of firms in the space. <em>Empirical Economics</em> 34(1): 81-103.</p>
<p>Diggle, P. J. and Chetwynd, A. G. (1991). Second-Order Analysis of Spatial Clustering for Inhomogeneous Populations. <em>Biometrics</em> 47(3): 1155-1163.</p>
<p>Marcon, E. and F. Puech (2017). A typology of distance-based measures of spatial concentration. <em>Regional Science and Urban Economics</em>. 62:56-67.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The computation of <code>Dhat</code> relies on spatstat functions <code><a href="https://rdrr.io/pkg/spatstat.explore/man/Kest.html" class="external-link">Kest</a></code> and <code><a href="https://rdrr.io/pkg/spatstat.explore/man/Kcross.html" class="external-link">Kcross</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Khat.html">Khat</a></code>, <code><a href="DEnvelope.html">DEnvelope</a></code>, <code><a href="https://rdrr.io/pkg/spatstat.explore/man/Kest.html" class="external-link">Kest</a></code>, <code><a href="https://rdrr.io/pkg/spatstat.explore/man/Kcross.html" class="external-link">Kcross</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">paracou16</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">paracou16</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Dhat-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate D</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">30</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">Paracou</span> <span class="op">&lt;-</span> <span class="fu">Dhat</span><span class="op">(</span><span class="va">paracou16</span>, <span class="va">r</span>, <span class="st">"V. Americana"</span>, <span class="st">"Q. Rosea"</span>, Intertype <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Function value object (class ‘fv’)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for the function r -&gt; D(r)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ................................................................</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Math.label     Description                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r    r              distance argument r                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theo D[theo](r)     theoretical Poisson D(r)                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iso  hat(D)[iso](r) Ripley isotropic correction estimate of D(r)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ................................................................</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Default plot formula:  .~r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> where “.” stands for ‘theo’, ‘iso’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Recommended range of argument r: [0, 30]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Available range of argument r: [0, 30]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot (after normalization by pi.r^2)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">Paracou</span>, <span class="va">.</span><span class="op">/</span><span class="op">(</span><span class="va">pi</span><span class="op">*</span><span class="va">r</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">~</span> <span class="va">r</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Dhat-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Marcon, Gabriel Lang, Stephane Traissac, Florence Puech.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

